# 摘要
DNSSEC的强密码密码部署对于DNS的长期安全至关重要。不幸的是，由于采用了新密码的障碍以及DNSSEC的limping部署，因此大多数域使用弱RSA-1024密码。   
部署新密码的主要问题是由于多个密码的支持，导致DNSSEC签名的响应产生的膨胀。这不仅会导致网络上的负载，而且更糟糕的是，它导致DNS查找故障，例如，许多网络设备阻止了如此巨大的数据包。仅仅放下旧的密码并使用新的强密码是一种选择，因为这会破坏所有不支持这些新密码的客户的DNS功能。支持客户和服务器上的新密码的要求以及可能导致的DNS失败，因为产生的较大响应减少了提高DNS安全性的动机。   
我们的目标是解决这个恶性循环。在这项工作中，我们提出了一种使用单面密码 - 套件谈判来部署新密码的方法。我们的机制使用机器学习来推断客户可能支持的密码集，然后从该列表中选择最佳的密码。我们的评估表明，我们的单面密码 - 套件谈判不仅允许域名不仅可以单方面提高安全性，而无需等待客户整合对新安全密码的支持，而且还可以通过降低失败来提高DNS性能   
我们的结果表明，单方面的解决方案不仅可以推动新密码的采用，而且还可以解决DNSSEC的现有互操作性问题。我们对将机器学习应用于这种情况的可行性的设计和初步分析导致更安全和可用的DNSSEC。我们概述了机器学习协助的密码 - 套件谈判的方法，并为未来的研究提供了步骤和挑战。   

# 引言
DNSSEC [RFC4033-RFC4035]提出了超过二十年前,但还没有广泛部署,只有1%的域签署和大多数DNS解析器并不验证响应。甚至更糟的是,签署域通常仍然脆弱由于配置错误的或弱密钥,[1,5]。不幸的是,支持多种密码不解决这个问题,因为额外的加密法案同样材料的域名系统安全扩展增加了签署了DNS数据包大小明显导致反应被中间网络设备。另一方面,选择和使用一个强密码也不是一个选择,因为许多DNS解析器没有支持新的密码。当一个解析器接收记录与密码不理解,验证失败。因此,大部分的DNS服务器还支持RSA 1024, [4]。即使是现在,当大多数解析器支持旧密码和不够强大钥匙,DNSSEC-signed反应往往受阻导致客户连接问题。建议密码套件法案同样谈判的域名系统安全扩展,采用[2、3],没有看到,因为他们需要修改解析器和域名服务器。其它建议考虑带外通道等信号支持的密码在传输层版机制[RFC6975]。虽然标准化八年前他们仍然不支持的DNS解析器在互联网   
我们的贡献。在这项工作中，我们提出了一种将密码集成到DNSSEC中的新方法。根据我们的建议，域可以单方面部署新密码。我们建议背后的关键思想是，名称服务器可以根据从DNS请求中获得的信息进行推断，而解析程序可能无法处理这些信息。在名称服务器端，我们持续监控与解析器的通信，并使用机器学习（ML）动态构建模型，了解每个解析器支持的密码。这些模型是基于缓存和查询行为以及DNS请求的IP和传输头中的属性构建的。为了学习解析器的行为，我们使用基于决策树（DT）的方法。从预测的支持密码集合中，基于服务器端偏好选择DNS响应的密码。预测算法支持的分类器是基于大量网络跟踪和对互联网上的开放解析器和我们实验室中流行的解析器软件的查询和响应进行预训练的。接下来，我们的服务器端模块从域使用的密码中选择解析器支持的最佳（即最强）密码。我们的机制允许域单方面采用新密码，而不会使客户端暴露于潜在的连接故障。具有支持新密码的DNS解析器的客户端立即享受额外的安全优势。另一方面，当名称服务器与支持多个密码或具有不同大小的多个密钥的密码的解析器通信时，我们的机制减少了失败

# 方法
**设计** 目标是为每个给定的解析器确定最佳密码，并仅使用该密码发送响应。在名称服务器上，我们为给定域支持的n个密码中的每个创建n个区域文件副本。区域文件的每个副本都由一个密码签名。在与解析器通信期间，服务器应用ML来决定要使用的最佳密码，并从相应的区域文件中提供记录。

**机器学习特征** 服务器使用来自DNS解析器的查询来决定最适合与该解析器通信的密码。我们从时域、TCP/IP报头和解析器发送的DNS请求包的有效负载中提取特征。  
*时域* 这些特性与DNS解析器的查询行为有关。  
*传输层特征* 这些是EDNS和用于通信的传输层协议中的特征。  
*DNS头特征* DNS头的参数  
*IP头特征* IP头的参数，可以用来识别解析器的OS  
*payload* DNS查询和解析器的缓存行为  
该信息被馈送到预先训练的模型中，该模型将确定所述解析器所理解的密码套件集合的预测。权威名称服务器给出的响应将使用最好的预测密码套件。该过程如图2所示。在所示的情况下，发送带有Ed25519签名的响应。  
![image](https://user-images.githubusercontent.com/49114842/203488076-39c67ae2-17fe-4c1f-9abc-7d985309af91.png)

**训练模型** 使用机器学习技术进行训练的该模型用于密码选择。我们在图1中描述了训练过程。
![image](https://user-images.githubusercontent.com/49114842/203488582-8acd1d4d-cece-4d4d-b2fd-ee9358227b7c.png)（1） 通过部署广告网络收集培训数据。客户端上的广告会触发对我们的名称服务器的查询。我们从广告客户端收集有关查询成功的信息，并从权威名称服务器的查询中收集有关解析器查询的信息。（2） 收集的数据用于使用机器学习来训练预测模型。（3） 该模型用于预测真实场景中支持的密码。   
对于任何训练，都必须获得有关使用所选密码套件验证是否成功的反馈。我们使用广告网络收集这些数据，广告指示客户端计算机使用预先配置的解析器查询DNS中的某些区域。然后可以为正在使用的解析器确定验证是否发生，以及验证是否成功。这是针对许多不同的密码套件1完成的。通过在DNS查询中编码唯一的客户端id，该数据与在我们域的权威名称服务器上记录的DNS流量数据相匹配，以创建预测模型的训练集；表1中显示了一个示例。   ![image](https://user-images.githubusercontent.com/49114842/203489026-60fc729b-8a6e-4d71-8b90-57266cbb853d.png)  
在我们的测量中，我们总共收集了207个解析器，包括我们的8个实验室解析器、13个流行的开放解析器服务和186个随机选择的验证解析器，这些解析器来自UDP/53端口扫描，用于解析我们的域。使用我们控制的客户端查询响应中的RCODE和AD标志，我们能够确定哪些解析器支持哪些算法以及密钥大小（仅限RSA）。结果如表2所示。     ![image](https://user-images.githubusercontent.com/49114842/203489162-8c8184a5-8cdc-4628-9ee0-1f055fde1843.png)   
**相关后续工作** 我们将我们的机制开发为一个单独的模块，该模块实现了我们的ML分类器，并根据它从解析器接收到的请求，确定要使用的最佳密码。我们还开发了一个脚本，该脚本在名称服务器上提供了一个区域文件和加密密钥，为每个密码生成一个单独的区域文件，每个区域文件都用相应的密钥签名。一旦确定了最佳密码，我们的模块就会向名称服务器上的脚本发出信号，告知应该使用哪个区域文件副本（使用相应的最佳密码进行保护）。   
# 评估
在本节中，我们将介绍初步评估结果。在获得每个密码的分类器后，我们通过与测试集（未用于训练的收集数据部分）进行比较来检查其预测的准确性。每个分类器显示出中等的准确性，错误预测的比例约占测试示例的三分之一。详细的指标如表3所示。   ![image](https://user-images.githubusercontent.com/49114842/203491890-2779dfca-4d49-485c-9593-9e0bdc06f782.png)   
训练数据的增加或特征数量的增加将进一步提高单个分类器的质量。最重要的是，我们的初步工作，包括分类器和训练数据，目前基于对服务器的单个DNS查询。然而，在典型的场景中，解析过程涉及到对服务器的多个查询，这进一步提高了精度。然而，请注意，单个分类器的错误猜测仅意味着我们的机制预测了另一个更好的密码，解析器仍然正确支持该密码。   为了评估密码选择机制的性能，我们使用分类器来预测将为测试集中包含的DNS查询选择哪个密码。因为对于测试集中的每个查询，发送它的负责DNS解析器是已知的，所以可以使用我们在实验室评估解析器时收集的解析器密码支持来评估预测的正确性。   
**实验结果** 该过程的结果表明，在99%以上的情况下，算法的选择与所涉及的解析器支持的最佳密码匹配。在预测不正确的情况下，解析器的能力大多被低估，导致安全性比所讨论的解析器可能的安全性更弱。另一方面，解析器的能力被高估，并且解析器侧的验证被跳过的情况相对较少。总的来说，对于几乎所有的解析器，使用我们的机制选择的密码可以实现的安全性高于将密码设置为建议的设置（即ecdsap256sha256）所能实现的安全。（例外是bind9113、kresd532和cznic odvr，后者可能使用kresd）。
