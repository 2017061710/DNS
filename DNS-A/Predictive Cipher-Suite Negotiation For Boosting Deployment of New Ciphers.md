# 摘要
DNSSEC的强密码密码部署对于DNS的长期安全至关重要。不幸的是，由于采用了新密码的障碍以及DNSSEC的limping部署，因此大多数域使用弱RSA-1024密码。
部署新密码的主要问题是由于多个密码的支持，导致DNSSEC签名的响应产生的膨胀。这不仅会导致网络上的负载，而且更糟糕的是，它导致DNS查找故障，例如，许多网络设备阻止了如此巨大的数据包。仅仅放下旧的密码并使用新的强密码是一种选择，因为这会破坏所有不支持这些新密码的客户的DNS功能。支持客户和服务器上的新密码的要求以及可能导致的DNS失败，因为产生的较大响应减少了提高DNS安全性的动机。
我们的目标是解决这个恶性循环。在这项工作中，我们提出了一种使用单面密码 - 套件谈判来部署新密码的方法。我们的机制使用机器学习来推断客户可能支持的密码集，然后从该列表中选择最佳的密码。我们的评估表明，我们的单面密码 - 套件谈判不仅允许域名不仅可以单方面提高安全性，而无需等待客户整合对新安全密码的支持，而且还可以通过降低失败来提高DNS性能
我们的结果表明，单方面的解决方案不仅可以推动新密码的采用，而且还可以解决DNSSEC的现有互操作性问题。我们对将机器学习应用于这种情况的可行性的设计和初步分析导致更安全和可用的DNSSEC。我们概述了机器学习协助的密码 - 套件谈判的方法，并为未来的研究提供了步骤和挑战。

# 引言
DNSSEC [RFC4033-RFC4035]提出了超过二十年前,但还没有广泛部署,只有1%的域签署和大多数DNS解析器并不验证响应。甚至更糟的是,签署域通常仍然脆弱由于配置错误的或弱密钥,[1,5]。不幸的是,支持多种密码不解决这个问题,因为额外的加密法案同样材料的域名系统安全扩展增加了签署了DNS数据包大小明显导致反应被中间网络设备。另一方面,选择和使用一个强密码也不是一个选择,因为许多DNS解析器没有支持新的密码。当一个解析器接收记录与密码不理解,验证失败。因此,大部分的DNS服务器还支持RSA 1024, [4]。即使是现在,当大多数解析器支持旧密码和不够强大钥匙,DNSSEC-signed反应往往受阻导致客户连接问题。建议密码套件法案同样谈判的域名系统安全扩展,采用[2、3],没有看到,因为他们需要修改解析器和域名服务器。其它建议考虑带外通道等信号支持的密码在传输层版机制[RFC6975]。虽然标准化八年前他们仍然不支持的DNS解析器在互联网
我们的贡献。在这项工作中，我们提出了一种将密码集成到DNSSEC中的新方法。根据我们的建议，域可以单方面部署新密码。我们建议背后的关键思想是，名称服务器可以根据从DNS请求中获得的信息进行推断，而解析程序可能无法处理这些信息。在名称服务器端，我们持续监控与解析器的通信，并使用机器学习（ML）动态构建模型，了解每个解析器支持的密码。这些模型是基于缓存和查询行为以及DNS请求的IP和传输头中的属性构建的。为了学习解析器的行为，我们使用基于决策树（DT）的方法。从预测的支持密码集合中，基于服务器端偏好选择DNS响应的密码。预测算法支持的分类器是基于大量网络跟踪和对互联网上的开放解析器和我们实验室中流行的解析器软件的查询和响应进行预训练的。接下来，我们的服务器端模块从域使用的密码中选择解析器支持的最佳（即最强）密码。我们的机制允许域单方面采用新密码，而不会使客户端暴露于潜在的连接故障。具有支持新密码的DNS解析器的客户端立即享受额外的安全优势。另一方面，当名称服务器与支持多个密码或具有不同大小的多个密钥的密码的解析器通信时，我们的机制减少了失败

# 方法
**设计** 目标是为每个给定的解析器确定最佳密码，并仅使用该密码发送响应。在名称服务器上，我们为给定域支持的n个密码中的每个创建n个区域文件副本。区域文件的每个副本都由一个密码签名。在与解析器通信期间，服务器应用ML来决定要使用的最佳密码，并从相应的区域文件中提供记录。

**机器学习特征** 服务器使用来自DNS解析器的查询来决定最适合与该解析器通信的密码。我们从时域、TCP/IP报头和解析器发送的DNS请求包的有效负载中提取特征。
*时域* 这些特性与DNS解析器的查询行为有关。
*传输层特征* 这些是EDNS和用于通信的传输层协议中的特征。
*DNS头特征* DNS头的参数
*IP头特征* IP头的参数，可以用来识别解析器的OS
*payload* DNS查询和解析器的缓存行为
然后，该信息被馈送到预先训练的模型中，该模型将确定所述解析器所理解的密码套件集合的预测。权威名称服务器给出的响应将使用最好的预测密码套件。该过程如图2所示。在所示的情况下，发送带有Ed25519签名的响应。

![image](https://user-images.githubusercontent.com/49114842/203488076-39c67ae2-17fe-4c1f-9abc-7d985309af91.png)

**训练模型** 使用机器学习技术进行训练的该模型用于密码选择。我们在图1中描述了训练过程。
![image](https://user-images.githubusercontent.com/49114842/203488582-8acd1d4d-cece-4d4d-b2fd-ee9358227b7c.png)（1） 通过部署广告网络收集培训数据。客户端上的广告会触发对我们的名称服务器的查询。我们从广告客户端收集有关查询成功的信息，并从权威名称服务器的查询中收集有关解析器查询的信息。（2） 收集的数据用于使用机器学习来训练预测模型。（3） 该模型用于预测真实场景中支持的密码。
对于任何训练，都必须获得有关使用所选密码套件验证是否成功的反馈。我们使用广告网络收集这些数据，广告指示客户端计算机使用预先配置的解析器查询DNS中的某些区域。然后可以为正在使用的解析器确定验证是否发生，以及验证是否成功。这是针对许多不同的密码套件1完成的。通过在DNS查询中编码唯一的客户端id，该数据与在我们域的权威名称服务器上记录的DNS流量数据相匹配，以创建预测模型的训练集；表1中显示了一个示例。
